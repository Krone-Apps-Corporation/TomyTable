/*
 *  Document   : tomytable.css
 *  Author     : Tomy Vinciguera By Krône Apps Corporation
 *  Description: The javascript file of TomyTable
 *  Version    : v1.0.0
 *
 */
 
$.fn.tomytable=function(t){var a=$.extend({datahtml:!1,theme:"ver1",ajaxload:!1,ajaxurl:"",data:{},hide_md:[],hide_sm:[],specialsort:[],tolist:[],toimg:[],sortnbr:[],action:[],gif:"images/",callback:function(){},callbackAjax:function(){},french:{nodata:"Aucune ligne à afficher !",loading:"Chargement...",show_1:"Afficher",line_1:"lignes",search:"Recherche",show_2:"Afficher",tooo_1:"jusqu'a",ooof_1:"de",line_2:"lignes"}},t);return this.each(function(){var t="undefined"!=typeof lang?lang.cnt:a.french,e=$(this).attr("id"),o=[],n=[],l=[],i=0,s=1,c=10,r=0,d=0,h=0,f=0,u=0,m="",p=function(t,e){var o,n,l=a.sortnbr,i=a.specialsort,s=t.replace("sort_","");return"Bon"!=a.sortnbr?function(a,c){return o=a[t],n=c[t],"number"!=typeof o&&"number"!=typeof n&&(l.indexOf(t)>=0||i.indexOf(s)>=0)&&(o=o.replace(" ",""),n=n.replace(" ",""),o=parseInt(o),n=parseInt(n)),1==e?o>n?1:o<n?-1:0:o<n?1:o>n?-1:0}:function(a,l){return o=a[t],n=l[t],1==e?o>n?1:o<n?-1:0:o<n?1:o>n?-1:0}},v=function(t){$(".column100").unbind("mouseover").on("mouseover",function(){var t=$(this).parent().parent().parent(),a=$(this).parent().parent(),e=$(t).data("vertable")+"",o=$(this).data("column")+"";$(a).find("."+o).addClass("hov-column-"+e),$(t).find(".row100.head ."+o).addClass("hov-column-head-"+e),$(t).find(".row100.foot ."+o).addClass("hov-column-head-"+e)}),$(".column100").unbind("mouseout").on("mouseout",function(){var t=$(this).parent().parent().parent(),a=$(this).parent().parent(),e=$(t).data("vertable")+"",o=$(this).data("column")+"";$(a).find("."+o).removeClass("hov-column-"+e),$(t).find(".row100.head ."+o).removeClass("hov-column-head-"+e),$(t).find(".row100.foot ."+o).removeClass("hov-column-head-"+e)}),$("#"+t+"-txt1").unbind("change").change(function(){c=parseInt($(this).val()),i=Math.ceil(r/c),s=1,d=0,h=c<r?c:r,$("#"+t+"-txt4 .pagination").html("");for(var a=i<5?i:5,e=1;e<=a;e++)$("#"+t+"-txt4 .pagination").append("<li><a"+(1==e?' class="w3-red"':"")+' href="javascript:void(0)" name="'+e+'">'+e+"</a></li>");v(t),g(t)}),$("#"+t+" .head th, #"+t+" .foot th").unbind("click").click(function(){f=$(this).html();var e=a.specialsort;u=1-u,e.indexOf(f)>=0?f="sort_"+f:"Date"==f&&(f="dateint"),n.sort(p(f,u)),g(t)}),$("#"+t+"-txt2 input").unbind("keyup").keyup(function(){m=$(this).val(),n=[],r=o.length;for(var a=0,e=0;e<r;e++){for(var f=o[e],u="",p=0;p<l.length;p++){u=u+f[l[p]]+"-"}var v=new RegExp(m,"gi");result=u.match(v),result=(u.match(v)||[]).length,result>0&&(n.push(o[e]),a++)}0==m.length?(n=o,r=o.length,s=1,i=Math.ceil(r/c),d=0,h=r>c?c:r):(r=a,i=Math.ceil(r/c),s=1,d=0,h=r>c?c:r),$("#"+t+"-txt4 .pagination").html("");for(e=0;e<=i;e++)$("#"+t+"-txt4 .pagination").append("<li><a"+(1==e?' class="w3-red"':"")+' href="javascript:void(0)" name="'+e+'">'+e+"</a></li>");g(t),setTimeout(function(){$("#"+t+'-txt4 .pagination a[name="'+s+'"]').click()},1e3)}),x(t)},g=function(e){for(var o='<thead><tr class="row100 head">',i=0,s=a.hide_sm,c=a.hide_md,p=0;p<l.length;p++){i=p+1;var g="";l[p]==f&&(g=0==u?" tobot":" totop"),hide_cls="",s.indexOf(l[k])>=0&&(hide_cls+=" hidden-sm"),c.indexOf(l[k])>=0&&(hide_cls+=" hidden-md"),o+='<th class="column100 column'+i+g+hide_cls+'" data-column="column'+i+'" scope="col">'+l[p]+"</th>"}o+='</tr></thead><tfoot><tr class="row100 foot">';for(p=0;p<l.length;p++){i=p+1;g="";l[p]==f&&(g=0==u?" tobot":" totop"),hide_cls="",s.indexOf(l[k])>=0&&(hide_cls+=" hidden-sm"),c.indexOf(l[k])>=0&&(hide_cls+=" hidden-md"),o+='<th class="column100 column'+i+g+hide_cls+'" data-column="column'+i+'" scope="col">'+l[p]+"</th>"}if(o+="</tr></tfoot><tbody></tbody>",$("#"+e).html(o),$("#"+e+" tbody").html(""),n.length>0){o="",i=0;var b=h<r?h:r,x=a.tolist,_=a.toimg,w=a.action;for(p=d;p<b;p++){var y=n[p];o+='<tr class="row100"'+(void 0!==y.color?' data-color="'+y.color+'"':"")+">";for(var k=0;k<l.length;k++){i=k+1;var j=y[l[k]];if(hide_cls="",s.indexOf(l[k])>=0&&(hide_cls+=" hidden-sm"),c.indexOf(l[k])>=0&&(hide_cls+=" hidden-md"),o+='<td class="column100 column'+i+hide_cls+'" data-column="column'+i+'" data-label="'+l[k]+'">',w.indexOf(l[k])>=0)for(var O=0;O<j.length;O++){o+='<a id="'+(C=j[O]).id+'" href="javascript:'+C.click+';" class="tomybtn btn-'+C.color+'">'+C.content+"</a>"}else if(x.indexOf(l[k])>=0){o+='<ul class="tomytable-list">';for(O=0;O<j.length;O++){var C;o+="<li>"+(C=j[O])+"</li>"}o+="</ul>"}else if(_.indexOf(l[k])>=0){o+="<img"+(void 0!==j.src?' src="'+j.src+'"':"")+(void 0!==j.alt?' alt="'+j.alt+'"':"")+(void 0!==j.id?' id="'+j.id+'"':"")+(void 0!==j.class?' class="'+j.class+' tomytable-image"':' class="tomytable-image"')+" />"}else{if(m.length>0){new RegExp(m,"gi");if(null!==j)try{throw"replace"}catch(t){console.log(t)}else j=""}o+=j}o+="</td>"}o+="</tr>"}$("#"+e+" tbody").html(o),$("#"+e+"-txt3").html(t.show_2+" "+d+" "+t.tooo_1+" "+b+" "+t.ooof_1+" "+r+" "+t.line_2)}else{o='    \t\t\t\t\t<tr class="row100">    \t\t\t\t\t\t<td class="column100 column1" data-column="column1" colspan="'+$("#"+e+" thead tr th").length+'">'+t.nodata+"</td>    \t\t\t\t\t</td>    \t\t\t\t",$("#"+e+"-txt3").html(t.nodata),$("#"+e+" tbody").html(o)}v(e)},b=function(a){$("#"+a).parent().prepend('\t\t\t\t\t<div class="table-details row">\t\t\t\t\t\t<div class="col-md-6 col-sm-12">\t\t\t\t\t\t\t<label>\t\t\t\t\t\t\t\t'+t.show_1+' \t\t\t\t\t\t\t\t<select class="custom-select custom-select-sm form-control form-control-sm" id="'+a+'-txt1">\t\t\t\t\t\t\t\t\t<option value="10">10</option>\t\t\t\t\t\t\t\t\t<option value="25">25</option>\t\t\t\t\t\t\t\t\t<option value="50">50</option>\t\t\t\t\t\t\t\t\t<option value="100">100</option>\t\t\t\t\t\t\t\t\t<option value="500">500</option>\t\t\t\t\t\t\t\t</select> \t\t\t\t\t\t\t\t'+t.line_1+'\t\t\t\t\t\t\t</label>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="col-md-6 col-sm-12 text-right">\t\t\t\t\t\t\t<div id="'+a+'-txt2">\t\t\t\t\t\t\t\t<label>\t\t\t\t\t\t\t\t\tRecherche:\t\t\t\t\t\t\t\t\t<input type="search" class="form-control form-control-sm" placeholder="'+t.search+'">\t\t\t\t\t\t\t\t</label>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t    \t\t'),$("#"+a).parent().append('\t\t\t\t\t<div class="table-details row">\t\t\t\t\t\t<div class="col-md-6 col-sm-12" id="'+a+'-txt3"></div>\t\t\t\t\t\t<div class="col-md-6 col-sm-12 text-right">\t\t\t\t\t\t\t<div class="dataTables_paginate paging_simple_numbers" id="'+a+'-txt4">\t\t\t\t\t\t\t\t<ul class="pagination"></ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t    \t\t')},x=function(t){$("#"+t+"-txt4 .pagination a").unbind("click").click(function(){s=parseInt($(this).attr("name")),h=(h=(d=(s-1)*c)+c)<r?h:r,$("#"+t+"-txt4 .pagination a").removeClass("w3-red"),$("#"+t+'-txt4 .pagination a[name="'+s+'"]').addClass("w3-red"),_(t,s),g(t)})},_=function(t,a){var e=0,o=0;a<4?(e=1,o=i<6?i:5):i-a<4?(e=i-4,o=i):(e=a-2,o=a+2);$("#"+t+"-txt4 .pagination").html("");for(var n=e;n<=o;n++)$("#"+t+"-txt4 .pagination").append("<li><a"+(n==a?' class="w3-red"':"")+' href="javascript:void(0)" name="'+n+'">'+n+"</a></li>");x(t)};if($(this).attr("data-vertable",a.theme),$(this).parent().addClass(a.theme),a.datahtml){for(var w=$(this).find("thead tr th"),y=0;y<w.length;y++)l.push($(w[y]).html());var k=$(this).find("tbody tr");for(y=0;y<k.length;y++){for(var j=$(k[y]).find("td"),O={},C=0;C<j.length;C++)O[l[C]]=$(j[C]).html();n.push(O),o.push(O),r++}r<c?(i=1,h=r):(i=Math.ceil(r/c),h=c),b(e),_(e,1),g(e),callback=a.callback,callback()}else if(a.ajaxload){for(w=$(this).find("thead tr th"),y=0;y<w.length;y++)l.push($(w[y]).html());var I='<thead><tr class="row100 head"><th class="column100 column1" data-column="column1" scope="col">'+t.loading+'</th></tr></thead><tfoot><tr class="row100 foot"><th class="column100 column1" data-column="column1" scope="col">Chargement...</th></tr></tfoot><tbody><tr><td><img src="'+a.gif+'load.gif" alt="loading..."></td></tr></tbody>';$("#"+e).html(I),function(t){$.post(a.ajaxurl,a.data,function(e){if(/^{.*}$/.test(e)&&"object"==typeof(e=JSON.parse(e))){if(data=e.data,100==data)for(var s=0;s<data.length;s++)for(var d=data[s],f=0;f<d.length;f++)o.push(d[f]);else o=e.data;n=o;var u=$(this).find("thead tr th");for(s=0;s<u.length;s++)l.push($(u[s]).html());(r=o.length)<c?(i=1,h=r):(i=Math.ceil(r/c),h=c),b(t),_(t,1),g(t),callbackAjax=a.callbackAjax,callbackAjax(e)}})}(e)}else if(a.data.length>0){o=a.data,n=a.data;for(w=$(this).find("thead tr th"),y=0;y<w.length;y++)l.push($(w[y]).html());(r=o.length)<c?(i=1,h=r):(i=Math.ceil(r/c),h=c),b(e),_(e,1),g(e),callback=a.callback,callback()}else o=[],n=[],l=[],i=0,s=1,c=10,r=0,d=0,h=0,f=0,u=0,m="";this.removeLine=function(t){for(var a=[],l=[],s=0;s<r;s++){void 0!==(d=o[s]).ID&&d.ID!=t&&l.push(d)}o=l;for(s=0;s<n.length;s++){var d;void 0!==(d=n[s]).ID&&d.ID!=t&&a.push(d)}n=a,--r<c?(i=1,h=r):(i=Math.ceil(r/c),h=c),_(e,1),g(e)},this.editLine=function(t){$.post(a.ajaxurl,a.data,function(t){if(/^{.*}$/.test(t)&&"object"==typeof(t=JSON.parse(t))){if(data=t.data,100==data)for(var a=0;a<data.length;a++)for(var l=data[a],i=0;i<l.length;i++)o.push(l[i]);else o=t.data;n=o,g(e),_(e,1)}})},this.getLine=function(t){for(var a={},e=0;e<r;e++){var n=o[e];void 0!==n.ID&&n.ID!=t&&(a=n)}return a},this.getColumn=function(t,a){for(var e,n=0;n<r;n++){var l=o[n];void 0!==l.ID&&l.ID!=t&&(e=l[a])}return e},this.datesort=function(){n.sort(p("dateint",0)),g(e)},this.specialsort=function(t){!function(t){n.sort(p(t,0)),g(e)}(t)},this.refresh=function(t,a){_(e,1),g(e)}})};