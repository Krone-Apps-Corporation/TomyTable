/*
 *  Document   : tomytable.css
 *  Author     : Tomy Vinciguera By Krône Apps Corporation
 *  Description: The javascript file of TomyTable
 *  Version    : v1.0.0
 *
*/

$.fn.tomytable=function(t){var a=$.extend({datahtml:!1,theme:"ver1",ajaxload:!1,ajaxurl:"",data:{},hide_md:[],hide_sm:[],specialsort:[],tolist:[],toimg:[],sortnbr:[],action:[],gif:"images/",callback:function(){},callbackAjax:function(){},french:{nodata:"Aucune ligne à afficher !",loading:"Chargement...",show_1:"Afficher",line_1:"lignes",search:"Recherche",show_2:"Afficher",tooo_1:"jusqu'a",ooof_1:"de",line_2:"lignes"},english:{nodata:"No data to show !",loading:"Loading...",show_1:"Show",line_1:"entries",search:"Search",show_2:"Showing",tooo_1:"to",ooof_1:"of",line_2:"entries"},spanish:{nodata:"No hay líneas para mostrar !",loading:"Cargando...",show_1:"Exhibición",line_1:"líneas",search:"Buscar",show_2:"Exhibición",tooo_1:"hasta",ooof_1:"de",line_2:"líneas"},deutsch:{nodata:"Keine Zeilen zum Anzeigen !",loading:"Beladung...",show_1:"Anzeige",line_1:"linien",search:"Suche",show_2:"Anzeige",tooo_1:"zu",ooof_1:"von",line_2:"linien"},italian:{nodata:"Nessuna riga da visualizzare !",loading:"Caricamento...",show_1:"Visualizzare",line_1:"linee",search:"Ricerca",show_2:"Visualizzare",tooo_1:"su",ooof_1:"di",line_2:"linee"},lng:"french"},t);return this.each(function(){var t="undefined"!=typeof lang?lang.cnt:a.french,o=$(this).attr("id"),e=[],n=[],i=[],l=0,s=1,c=10,r=0,d=0,h=0,f=0,u=0,m="",p=function(t,o){var e,n,i=a.sortnbr,l=a.specialsort,s=t.replace("sort_","");return"Bon"!=a.sortnbr?function(a,c){return e=a[t],n=c[t],"number"!=typeof e&&"number"!=typeof n&&(i.indexOf(t)>=0||l.indexOf(s)>=0)&&(e=e.replace(" ",""),n=n.replace(" ",""),e=parseInt(e),n=parseInt(n)),1==o?e>n?1:e<n?-1:0:e<n?1:e>n?-1:0}:function(a,i){return e=a[t],n=i[t],1==o?e>n?1:e<n?-1:0:e<n?1:e>n?-1:0}},v=function(t){$(".column100").unbind("mouseover").on("mouseover",function(){var t=$(this).parent().parent().parent(),a=$(this).parent().parent(),o=$(t).data("vertable")+"",e=$(this).data("column")+"";$(a).find("."+e).addClass("hov-column-"+o),$(t).find(".row100.head ."+e).addClass("hov-column-head-"+o),$(t).find(".row100.foot ."+e).addClass("hov-column-head-"+o)}),$(".column100").unbind("mouseout").on("mouseout",function(){var t=$(this).parent().parent().parent(),a=$(this).parent().parent(),o=$(t).data("vertable")+"",e=$(this).data("column")+"";$(a).find("."+e).removeClass("hov-column-"+o),$(t).find(".row100.head ."+e).removeClass("hov-column-head-"+o),$(t).find(".row100.foot ."+e).removeClass("hov-column-head-"+o)}),$("#"+t+"-txt1").unbind("change").change(function(){c=parseInt($(this).val()),l=Math.ceil(r/c),s=1,d=0,h=c<r?c:r,$("#"+t+"-txt4 .pagination").html("");for(var a=l<5?l:5,o=1;o<=a;o++)$("#"+t+"-txt4 .pagination").append("<li><a"+(1==o?' class="w3-red"':"")+' href="javascript:void(0)" name="'+o+'">'+o+"</a></li>");v(t),g(t)}),$("#"+t+" .head th, #"+t+" .foot th").unbind("click").click(function(){f=$(this).html();var o=a.specialsort;u=1-u,o.indexOf(f)>=0?f="sort_"+f:"Date"==f&&(f="dateint"),n.sort(p(f,u)),g(t)}),$("#"+t+"-txt2 input").unbind("keyup").keyup(function(){m=$(this).val(),n=[],r=e.length;for(var a=0,o=0;o<r;o++){for(var f=e[o],u="",p=0;p<i.length;p++){u=u+f[i[p]]+"-"}var v=new RegExp(m,"gi");result=u.match(v),result=(u.match(v)||[]).length,result>0&&(n.push(e[o]),a++)}0==m.length?(n=e,r=e.length,s=1,l=Math.ceil(r/c),d=0,h=r>c?c:r):(r=a,l=Math.ceil(r/c),s=1,d=0,h=r>c?c:r),$("#"+t+"-txt4 .pagination").html("");for(o=0;o<=l;o++)$("#"+t+"-txt4 .pagination").append("<li><a"+(1==o?' class="w3-red"':"")+' href="javascript:void(0)" name="'+o+'">'+o+"</a></li>");g(t),setTimeout(function(){$("#"+t+'-txt4 .pagination a[name="'+s+'"]').click()},1e3)}),b(t)},g=function(o){for(var e='<thead><tr class="row100 head">',l=0,s=a.hide_sm,c=a.hide_md,p=0;p<i.length;p++){l=p+1;var g="";i[p]==f&&(g=0==u?" tobot":" totop"),hide_cls="",s.indexOf(i[k])>=0&&(hide_cls+=" hidden-sm"),c.indexOf(i[k])>=0&&(hide_cls+=" hidden-md"),e+='<th class="column100 column'+l+g+hide_cls+'" data-column="column'+l+'" scope="col">'+i[p]+"</th>"}e+='</tr></thead><tfoot><tr class="row100 foot">';for(p=0;p<i.length;p++){l=p+1;g="";i[p]==f&&(g=0==u?" tobot":" totop"),hide_cls="",s.indexOf(i[k])>=0&&(hide_cls+=" hidden-sm"),c.indexOf(i[k])>=0&&(hide_cls+=" hidden-md"),e+='<th class="column100 column'+l+g+hide_cls+'" data-column="column'+l+'" scope="col">'+i[p]+"</th>"}if(e+="</tr></tfoot><tbody></tbody>",$("#"+o).html(e),$("#"+o+" tbody").html(""),n.length>0){e="",l=0;var _=h<r?h:r,b=a.tolist,x=a.toimg,w=a.action;for(p=d;p<_;p++){var y=n[p];e+='<tr class="row100"'+(void 0!==y.color?' data-color="'+y.color+'"':"")+">";for(var k=0;k<i.length;k++){l=k+1;var j=y[i[k]];if(hide_cls="",s.indexOf(i[k])>=0&&(hide_cls+=" hidden-sm"),c.indexOf(i[k])>=0&&(hide_cls+=" hidden-md"),e+='<td class="column100 column'+l+hide_cls+'" data-column="column'+l+'" data-label="'+i[k]+'">',w.indexOf(i[k])>=0)for(var C=0;C<j.length;C++){e+='<a id="'+(O=j[C]).id+'" href="javascript:'+O.click+';" class="tomybtn btn-'+O.color+'">'+O.content+"</a>"}else if(b.indexOf(i[k])>=0){e+='<ul class="tomytable-list">';for(C=0;C<j.length;C++){var O;e+="<li>"+(O=j[C])+"</li>"}e+="</ul>"}else if(x.indexOf(i[k])>=0){e+="<img"+(void 0!==j.src?' src="'+j.src+'"':"")+(void 0!==j.alt?' alt="'+j.alt+'"':"")+(void 0!==j.id?' id="'+j.id+'"':"")+(void 0!==j.class?' class="'+j.class+' tomytable-image"':' class="tomytable-image"')+" />"}else{if(m.length>0){new RegExp(m,"gi");if(null!==j)try{throw"replace"}catch(t){console.log(t)}else j=""}e+=j}e+="</td>"}e+="</tr>"}$("#"+o+" tbody").html(e),$("#"+o+"-txt3").html(t.show_2+" "+d+" "+t.tooo_1+" "+_+" "+t.ooof_1+" "+r+" "+t.line_2)}else{e='    \t\t\t\t\t<tr class="row100">    \t\t\t\t\t\t<td class="column100 column1" data-column="column1" colspan="'+$("#"+o+" thead tr th").length+'">'+t.nodata+"</td>    \t\t\t\t\t</td>    \t\t\t\t",$("#"+o+"-txt3").html(t.nodata),$("#"+o+" tbody").html(e)}v(o)},_=function(a){$("#"+a).parent().prepend('\t\t\t\t\t<div class="table-details row">\t\t\t\t\t\t<div class="col-md-6 col-sm-12">\t\t\t\t\t\t\t<label>\t\t\t\t\t\t\t\t'+t.show_1+' \t\t\t\t\t\t\t\t<select class="custom-select custom-select-sm form-control form-control-sm" id="'+a+'-txt1">\t\t\t\t\t\t\t\t\t<option value="10">10</option>\t\t\t\t\t\t\t\t\t<option value="25">25</option>\t\t\t\t\t\t\t\t\t<option value="50">50</option>\t\t\t\t\t\t\t\t\t<option value="100">100</option>\t\t\t\t\t\t\t\t\t<option value="500">500</option>\t\t\t\t\t\t\t\t</select> \t\t\t\t\t\t\t\t'+t.line_1+'\t\t\t\t\t\t\t</label>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="col-md-6 col-sm-12 text-right">\t\t\t\t\t\t\t<div id="'+a+'-txt2">\t\t\t\t\t\t\t\t<label>\t\t\t\t\t\t\t\t\tRecherche:\t\t\t\t\t\t\t\t\t<input type="search" class="form-control form-control-sm" placeholder="'+t.search+'">\t\t\t\t\t\t\t\t</label>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t    \t\t'),$("#"+a).parent().append('\t\t\t\t\t<div class="table-details row">\t\t\t\t\t\t<div class="col-md-6 col-sm-12" id="'+a+'-txt3"></div>\t\t\t\t\t\t<div class="col-md-6 col-sm-12 text-right">\t\t\t\t\t\t\t<div class="dataTables_paginate paging_simple_numbers" id="'+a+'-txt4">\t\t\t\t\t\t\t\t<ul class="pagination"></ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t    \t\t')},b=function(t){$("#"+t+"-txt4 .pagination a").unbind("click").click(function(){s=parseInt($(this).attr("name")),h=(h=(d=(s-1)*c)+c)<r?h:r,$("#"+t+"-txt4 .pagination a").removeClass("w3-red"),$("#"+t+'-txt4 .pagination a[name="'+s+'"]').addClass("w3-red"),x(t,s),g(t)})},x=function(t,a){var o=0,e=0;a<4?(o=1,e=l<6?l:5):l-a<4?(o=l-4,e=l):(o=a-2,e=a+2);$("#"+t+"-txt4 .pagination").html("");for(var n=o;n<=e;n++)$("#"+t+"-txt4 .pagination").append("<li><a"+(n==a?' class="w3-red"':"")+' href="javascript:void(0)" name="'+n+'">'+n+"</a></li>");b(t)};if($(this).attr("data-vertable",a.theme),$(this).parent().addClass(a.theme),a.datahtml){for(var w=$(this).find("thead tr th"),y=0;y<w.length;y++)i.push($(w[y]).html());var k=$(this).find("tbody tr");for(y=0;y<k.length;y++){for(var j=$(k[y]).find("td"),C={},O=0;O<j.length;O++)C[i[O]]=$(j[O]).html();n.push(C),e.push(C),r++}r<c?(l=1,h=r):(l=Math.ceil(r/c),h=c),_(o),x(o,1),g(o),callback=a.callback,callback()}else if(a.ajaxload){for(w=$(this).find("thead tr th"),y=0;y<w.length;y++)i.push($(w[y]).html());var I='<thead><tr class="row100 head"><th class="column100 column1" data-column="column1" scope="col">'+t.loading+'</th></tr></thead><tfoot><tr class="row100 foot"><th class="column100 column1" data-column="column1" scope="col">Chargement...</th></tr></tfoot><tbody><tr><td><img src="'+a.gif+'load.gif" alt="loading..."></td></tr></tbody>';$("#"+o).html(I),function(t){$.post(a.ajaxurl,a.data,function(o){if(/^{.*}$/.test(o)&&"object"==typeof(o=JSON.parse(o))){if(data=o.data,100==data)for(var s=0;s<data.length;s++)for(var d=data[s],f=0;f<d.length;f++)e.push(d[f]);else e=o.data;n=e;var u=$(this).find("thead tr th");for(s=0;s<u.length;s++)i.push($(u[s]).html());(r=e.length)<c?(l=1,h=r):(l=Math.ceil(r/c),h=c),_(t),x(t,1),g(t),callbackAjax=a.callbackAjax,callbackAjax(o)}})}(o)}else if(a.data.length>0){e=a.data,n=a.data;for(w=$(this).find("thead tr th"),y=0;y<w.length;y++)i.push($(w[y]).html());(r=e.length)<c?(l=1,h=r):(l=Math.ceil(r/c),h=c),_(o),x(o,1),g(o),callback=a.callback,callback()}else e=[],n=[],i=[],l=0,s=1,c=10,r=0,d=0,h=0,f=0,u=0,m="";this.removeLine=function(t){for(var a=[],i=[],s=0;s<r;s++){void 0!==(d=e[s]).ID&&d.ID!=t&&i.push(d)}e=i;for(s=0;s<n.length;s++){var d;void 0!==(d=n[s]).ID&&d.ID!=t&&a.push(d)}n=a,--r<c?(l=1,h=r):(l=Math.ceil(r/c),h=c),x(o,1),g(o)},this.editLine=function(t){$.post(a.ajaxurl,a.data,function(t){if(/^{.*}$/.test(t)&&"object"==typeof(t=JSON.parse(t))){if(data=t.data,100==data)for(var a=0;a<data.length;a++)for(var i=data[a],l=0;l<i.length;l++)e.push(i[l]);else e=t.data;n=e,g(o),x(o,1)}})},this.getLine=function(t){for(var a={},o=0;o<r;o++){var n=e[o];void 0!==n.ID&&n.ID!=t&&(a=n)}return a},this.getColumn=function(t,a){for(var o,n=0;n<r;n++){var i=e[n];void 0!==i.ID&&i.ID!=t&&(o=i[a])}return o},this.datesort=function(){n.sort(p("dateint",0)),g(o)},this.specialsort=function(t){!function(t){n.sort(p(t,0)),g(o)}(t)},this.refresh=function(t,a){x(o,1),g(o)}})};